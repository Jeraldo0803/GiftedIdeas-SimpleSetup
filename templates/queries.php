<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Gifted Ideas</title>
    <link rel="stylesheet" href="../assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karla&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat+Alternates&amp;display=swap">
    <link rel="stylesheet" href="../assets/css/Carousel-Multi-Image--ISA-.css">
    <link rel="stylesheet" href="../assets/css/Hero-Clean-Reverse-images.css">
    <link rel="stylesheet" href="../assets/css/Lightbox-Gallery-baguetteBox.min.css">
    <link rel="stylesheet" href="../assets/css/styles.css">
    <!-- JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <div data-include="templates/header"></div>

    <div class="container-fluid">
        <div class="row row-cols-3">
            <div class="col-3" style="min-height: 84vmin;padding: 0px;">
                <div style="background: #FFE9C9;min-height: 100%;">
                    <div class="row text-center">
                        <div class="col">
                            <div class="row">
                                <div class="col" style="margin-top: 10vmax;margin-bottom: 15px;"><svg
                                        xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor"
                                        viewBox="0 0 16 16" class="bi bi-person-circle"
                                        style="min-height: 10vmax;min-width: 10vmax;">
                                        <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"></path>
                                        <path fill-rule="evenodd"
                                            d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1">
                                        </path>
                                    </svg></div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <h1
                                        style="font-family: 'Montserrat Alternates', sans-serif;font-size: 20px;font-weight: bold;margin-bottom: 0px;">
                                        Admin Name</h1>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <h1 style="font-family: 'Montserrat Alternates', sans-serif;font-size: 15px;">Admin
                                        Position</h1>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <div style="min-height: 15vmax;"></div>
                                    <div style="min-width: 100%;min-height: 13px;background: #a83565;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-4 d-xl-flex justify-content-xl-center align-items-xl-center">
                <div>
                    <div class="card text-center" style="box-shadow: 1px 4px 20px rgba(0,0,0,0.25);">
                        <div class="card-body" style="padding: 25px 16px;">
                            <h4 class="card-title" style="font-family: Karla, sans-serif;font-weight: bold;">View User
                                Information</h4>
                            <div class="row">
                                <div class="col">
                                    <h6 class="justify-content-xl-center align-items-xl-center mb-2"
                                        style="font-size: 13px;font-family: Karla, sans-serif;">New Registration</h6><a
                                        class="btn btn-primary" role="button"
                                        style="font-family: 'Montserrat Alternates', sans-serif;font-size: 13px;background: #A83565;width: 120px;border-color: var(--bs-navbar-toggler-border-color);border-radius: 5px;">View</a>
                                </div>
                                <div class="col">
                                    <h6 class="mb-2" style="font-size: 13px;font-family: Karla, sans-serif;">Edit Member
                                    </h6><a class="btn btn-primary" role="button"
                                        style="font-family: 'Montserrat Alternates', sans-serif;font-size: 13px;background: #A83565;width: 120px;border-color: var(--bs-navbar-toggler-border-color);border-radius: 5px;">View</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card text-center"
                        style="margin-top: 40px;margin-bottom: 100px;box-shadow: 1px 4px 20px rgba(0,0,0,0.25), 1px 4px 20px rgba(0,0,0,0.25);">
                        <div class="card-body" style="padding: 25px 16px;">
                            <h4 class="card-title" style="font-family: Karla, sans-serif;font-weight: bold;">User
                                Activities</h4><a class="btn btn-primary" role="button"
                                style="font-family: 'Montserrat Alternates', sans-serif;font-size: 13px;background: #A83565;border-color: var(--bs-navbar-toggler-border-color);border-radius: 5px;min-width: 95%;margin-bottom: 10px;">View
                                Queries</a><a class="btn btn-primary" role="button"
                                style="font-family: 'Montserrat Alternates', sans-serif;font-size: 13px;background: #A83565;border-color: var(--bs-navbar-toggler-border-color);border-radius: 5px;min-width: 95%;">View</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-5"><a href="admin.php" style="padding-bottom: 0px;padding-top: 0px;padding-right: 0px;"><svg
                        xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor"
                        viewBox="0 0 16 16" class="bi bi-x-square text-muted"
                        style="font-size: 30px;margin-top: 7px;margin-bottom: 11px;">
                        <path
                            d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z">
                        </path>
                        <path
                            d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708">
                        </path>
                    </svg></a>
                <div>
                    <h5 style="margin-top: 0px;">Queries</h5>
                    <hr>
                </div>
                <!--Just use this whole card div for showing message-->
                <div class="card">
                    <div class="card-body">

                        <?php
                        require ($_SERVER['DOCUMENT_ROOT'] . "/backend/connection.php");
                        $conn = get_connection();
                        $query = "SELECT Id, UserInquiryName, UserInquiryEmail, InquiryTime, InquiryDateString, UserInquiry, InquiryStatus, InquiryReply FROM UserInquiries ORDER BY InquiryTime DESC";
                        $result = mysqli_query($conn, $query);

                        if (mysqli_num_rows($result) > 0) {
                            while ($row = mysqli_fetch_assoc($result)) {
                                $senderName = $row["UserInquiryName"];
                                $senderEmail = $row["UserInquiryEmail"];
                                $timestamp = $row["InquiryTime"];
                                $inquiryDateString = $row["InquiryDateString"];
                                $message = $row["UserInquiry"];
                                $status = isset($row["InquiryStatus"]) ? $row["InquiryStatus"] : null;
                                $inquiryreply = $row["InquiryReply"];


                                $formattedTimestamp = date("F j, Y, g:i a", strtotime($timestamp));

                                echo '<div class="card">';
                                echo '<h4 class="card-title">' . $senderName . ' / ' . $senderEmail . '</h4>';
                                echo '<h6 class="text-muted card-subtitle mb-2">' . $formattedTimestamp . '</h6>';
                                echo '<p class="card-text">' . $message . '</p>';
                                echo '<p class="card-text">Day of Inquiry: ' . $inquiryDateString . '</p>'; // Display InquiryDateString
                                if ($status == "unresolved") {
                                    // Check if "id" key exists in $row array before using it
                                    if (isset($row["Id"])) {
                                        echo '<a class="card-link" href="../backend/remove_inquiry.php?id=' . $row["Id"] . '">remove</a>';
                                        echo '<a class="card-link" href="../backend/resolve_inquiry.php?id=' . $row["Id"] . '">resolve</a>';
                                        echo '<a class="card-link" href="../backend/reply_inquiry.php?id=' . $row["Id"] . '">reply?</a>';
                                    } else {
                                        echo "Error: Inquiry ID not found.";
                                    }
                                } else {
                                    echo '<a class="card-link" href="../backend/remove_inquiry.php?id=' . $row["Id"] . '">remove</a>';
                                    echo '<p class="text-success">Resolved</p>';
                                }
                                echo '</div>';
                            }
                        } else {
                            echo "No inquiries found.";
                        }

                        echo '
                        <h4 class="card-title">Sender name / email</h4>
                        <h6 class="text-muted card-subtitle mb-2">timestamp</h6>
                        <p class="card-text">Message bla bla bla Nullam id dolor id nibh ultricies vehicula ut id elit.
                            Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta
                            gravida at eget metus.</p><a class="card-link" href="#">remove?</a><a class="card-link"
                            href="#">resolve?</a>
                        ';
                        echo $inquiryreply;
                        ?>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <div data-include="templates/footer"></div>

    <script src="../assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="../assets/js/dom-to-image.min.js"></script>
    <script src="../assets/js/fabric.min.js"></script>
    <script src="../assets/js/Lightbox-Gallery-baguetteBox.min.js"></script>
    <script src="../assets/js/Lightbox-Gallery.js"></script>
    <script src="/src/global.js"></script>
</body>

</html>